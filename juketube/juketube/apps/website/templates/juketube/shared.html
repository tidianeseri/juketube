{% extends "juketube/base.html" %} 
{% load i18n %} 
{% block pagetitle %}JukeTube{% endblock %}
{% block slug %} Slug: <h2 id="playlist-slug"> {{playlist.slug}} </h2>{% endblock %}
{% block playlistname %} {{playlist}} {% endblock %}
{% block dropdownplaylist %}
<div class="dropdown pull-right hidden-xs hidden-md hidden-lg">
	<a class="blog-nav-item dropdown-toggle" href="#" data-toggle="dropdown">Info Playlist  <b class="caret"></b></a>
	<ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
		<li role="presentation"><a role="menuitem" tabindex="-1" href="#">Name: {{playlist}}</a></li>
		<li role="presentation"><a role="menuitem" tabindex="-1" href="#">Slug: {{playlist.slug}}</a></li>
		{% if not is_listener %}<li role="presentation"><a role="menuitem" tabindex="-1" href="{% url 'join_playlist' playlist.id %}">Join Playlist</a></li>{% endif %} 
	</ul>
</div>
{% endblock %}

{% block content %}
<div class="wrapper">
	<div class="dot-mask"></div>
	<div class="container">
		<div class="col-md-8">
			<div class="" id="youtube-player">
				<div id="ytapiplayer">You need Flash player 8+ and JavaScript
					enabled to view this video.</div>
			</div>
		</div>
		<div class="col-md-4">
			<div class="media" id="next-song">
				<div class="row video-element loadVideo" yt-id="{{ playlist.medias.all.0.media_id }}">
					<div class="media-img  pull-left col-xs-4 col-sm-2  col-md-4">
						<div class="img-overlay ">
							<a
								class="btn  btn-primary  animated fadeInUp glyphicon glyphicon-play"
								href="#" rel="bookmark"></a>
						</div>
						<img src="http://img.youtube.com/vi/{{ playlist.medias.all.0.media_id }}/0.jpg" alt="About"
							width="150" height="150">
					</div>
					<div class="media-body  col-xs-8 col-sm-10 col-md-8 loadVideo ">
						<h4 class="media-heading">
							<a href="#">Next Song</a>
						</h4>
						<p class="">{{ playlist.medias.all.0 }}</p>
					</div>
				</div>
			</div>

			<div id="playlist">
				<h1>Playlist</h1>
				<span id="refresh-playlist" title="Refresh Playlist"><span class="glyphicon glyphicon-refresh"></span></span>
				<span id="clear-playlist" title="Clear Playlist"><span class="glyphicon glyphicon-remove"></span></span>

				<div id="table-playlist">
				
				{% for media in playlist.playlistmedia_set.all %}
					<div class="media">
						<div class="row video-element" yt-id="{{ media.media.media_id }}"
							yt-title="{{ media.media.name }}" yt-duration="undefined" jkt-id="{{media.media.id}}" jkt-pos="{{  media.position }}">
							<div class="media-img  pull-left col-xs-2 col-sm-2 col-md-2 loadVideo ">
								<a href="#"><img src="http://img.youtube.com/vi/{{ media.media.media_id }}/0.jpg"
									alt="About" width="90" height="90"></a>
							</div>
							<div class="media-body col-xs-8 col-sm-8 col-md-8 loadVideo">
								<h4 class="media-heading">
									<a href="#">{{ media.media.name }}</a>
								</h4>
							</div>
							{% if is_listener %}
							<div class="col-xs-2 col-sm-2 col-md-2">
								<span class="glyphicon glyphicon-remove remVideo"></span>
							</div>
							{% endif %}
						</div>
					</div>
					{% endfor %}
 				
				</div>

			</div>

		</div>
	</div>
</div>

</div>

<div id="song-info">
	<div class="container">
		<h1>Playlist Info</h1>
		<div class="col-md-4">
			<span id="connection-status">Connecting...</span>
			<h4>Users</h4>
			<div id="current-listeners"></div>
			<div id="info-text"></div>
		</div>
		<div class="col-md-8">
			<h4>Lyrics</h4>
			<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.
				Aenean ut sapien et nibh auctor consequat quis id nulla. Curabitur
				sollicitudin tristique nunc, ornare pharetra magna mattis ac.
				Aliquam tortor nibh, pretium sit amet congue accumsan, suscipit vel
				velit. Duis sed urna eget mi rutrum dapibus. Mauris ut augue sed
				risus semper elementum ut sed justo.
		</div>
	</div>
</div>
{% if user.is_authenticated %}
<input type="hidden" id="idmedia" name="idmedia">
<input type="hidden" id="is_auth" name="is_auth">
<input type="hidden" id="playlist_id" name="playlist_id" value="{{playlist.id}}">
{% endif %}

{% endblock %}

{% block pagejs %}
<script type="text/javascript">
//player = new YoutubePlayer("ytapiplayer");
	var tag = document.createElement('script');

	tag.src = "https://www.youtube.com/iframe_api";
	var firstScriptTag = document.getElementsByTagName('script')[0];
	firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
	
	var ytplayer;
	function onYouTubeIframeAPIReady() {
	  ytplayer = new YT.Player('ytapiplayer', {
	    height: '100%',
	    width: '100%',
	    //videoId: 'T0BlXy3Roj4',
	    playerVars: {
	    	'controls': '0',
	    	'modestbranding': '1',
	    	'showinfo': '0',
	    	'autoplay': '0'
	       },
    	events: {
            'onReady': onYouTubePlayerReady,
            'onStateChange': onytplayerStateChange
          }
	  });
	}
	  function loadVideoPage() {
		  data = new Object();
		  {% for media in playlist.playlistmedia_set.all %}
			data.id = "{{ media.media.media_id }}";
			data.title = "{{ media.media.name }}";
			tr1 = new MediaYoutube(data);
			YT_PLAYLIST.add(tr1, false);
		  {% endfor %}
			/*YT_PLAYLIST.add(tr1);
			YT_PLAYLIST.add(tr2);
			YT_PLAYLIST.add(tr3);
			YT_PLAYLIST.add(tr4);*/
		}
</script>


{% if playlist.editable %}
<script src="http://localhost:4000/socket.io/socket.io.js"></script>
<script type="text/javascript">
var playlist_slug = "{{playlist.slug}}";
var playlist_id = "{{playlist.id}}";
var user = "{{user}}";
</script>
<script src="/static/juketube/js/juketube_shared.js" type="text/javascript">
</script>
{% endif %}

{% endblock %}